<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>Tempo Hub - Smart Mint</title>
    <script src="https://cdnjs.cloudflare.com/ajax/libs/ethers/5.7.2/ethers.umd.min.js"></script>
    <style>
        :root { --primary: #38bdf8; --bg: #0f172a; --card: #1e293b; --danger: #f87171; --warning: #fbbf24; --success: #22c55e; }
        body { background: var(--bg); color: white; font-family: 'Inter', sans-serif; display: flex; justify-content: center; align-items: center; min-height: 100vh; margin: 0; }
        .container { background: var(--card); padding: 2.5rem; border-radius: 24px; text-align: center; border: 1px solid rgba(255,255,255,0.1); width: 100%; max-width: 400px; box-shadow: 0 25px 50px -12px rgba(0,0,0,0.5); }
        .btn { background: var(--primary); color: var(--bg); border: none; padding: 1.2rem; width: 100%; border-radius: 12px; font-weight: 800; cursor: pointer; transition: 0.3s; }
        .btn:disabled { opacity: 0.4; cursor: wait; }
        #status-box { margin-top: 1.5rem; padding: 1rem; border-radius: 12px; font-size: 0.85rem; line-height: 1.4; background: rgba(255,255,255,0.03); min-height: 80px; display: flex; align-items: center; justify-content: center; }
        .status-err { color: var(--danger); border: 1px solid var(--danger); }
        .status-wait { color: var(--warning); border: 1px solid var(--warning); }
        .status-ok { color: var(--success); border: 1px solid var(--success); }
    </style>
</head>
<body>
    <div class="container">
        <h1 style="margin-top:0">Tempo Hub</h1>
        <p style="color: var(--primary); font-size: 0.8rem; letter-spacing: 1px; margin-bottom: 2rem;">MODERATO NETWORK</p>
        
        <div id="ui-content">
            <button id="mainBtn" class="btn">CONECTAR CARTEIRA</button>
            <div id="status-box">Aguardando interação...</div>
        </div>
    </div>

<script>
    const CONTRACT = "0x20c0000000000000000000000000000000000005";
    const ABI = ["function mint(address to, uint256 amount) public"];
    let walletSigner = null;

    const mainBtn = document.getElementById('mainBtn');
    const statusBox = document.getElementById('status-box');

    function updateStatus(msg, type = '') {
        statusBox.innerText = msg;
        statusBox.className = '';
        if (type) statusBox.classList.add(`status-${type}`);
    }

    // 1. Ligar Carteira
    mainBtn.onclick = async () => {
        if (!walletSigner) {
            try {
                if (!window.ethereum) throw new Error("Rabby não detetada.");
                const provider = new ethers.providers.Web3Provider(window.ethereum);
                await provider.send("eth_requestAccounts", []);
                walletSigner = provider.getSigner();
                mainBtn.innerText = "MINT STARTER KIT";
                updateStatus("Carteira ligada com sucesso!", "ok");
            } catch (e) {
                updateStatus("Erro ao ligar: " + e.message, "err");
            }
        } else {
            executeMint();
        }
    };

    // 2. Executar Mint com Notificações Inteligentes
    async function executeMint() {
        mainBtn.disabled = true;
        updateStatus("A validar elegibilidade na rede Moderato...", "wait");

        try {
            const contract = new ethers.Contract(CONTRACT, ABI, walletSigner);
            const userAddr = await walletSigner.getAddress();
            const amount = ethers.BigNumber.from("9982000000000000000000000");

            // Chamada de Mint
            const tx = await contract.mint(userAddr, amount, {
                gasLimit: 600000,
                gasPrice: 1000000002
            });

            updateStatus("Transação enviada! A aguardar confirmação dos blocos...", "wait");
